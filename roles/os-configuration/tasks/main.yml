---

- name: Install requirements
  package: 
     name:
       - gnome-tweak-tool
     state: present
  become: yes

- include_tasks: keyboard_shortcuts.yml
- include_tasks: systemd.yml
- include_tasks: gnome-extensions/main.yml


# Disable hot corners
- name: Disable hot corners
  dconf: 
     key: /org/gnome/desktop/interface/enable-hot-corners
     value: "false"

# Increase number of inotify watchers to prevent issues with some IDEs
# https://confluence.jetbrains.com/display/IDEADEV/Inotify+Watches+Limit

- name: Increase number of inotify watchers
  sysctl:
    name: fs.inotify.max_user_watches
    value: '524288'
    sysctl_set: yes
    state: present
    reload: yes
  become: yes

- name: Increase number of inotify instances (fixes issue with dotnet watch)
  sysctl:
    name: fs.inotify.max_user_instances
    value: '524288'
    sysctl_set: yes
    state: present
    reload: yes
  become: yes

  # Set hostname

- name: Set the hostname of the machine
  hostname:
    name: "{{ machine_hostname }}"
  when: machine_hostname != ""


# Other Gnome tweaks

- name: Set antialiasing to subpixel
  dconf: 
     key: /org/gnome/settings-daemon/plugins/xsettings/antialiasing
     value: "'rgba'"

# # Enable automatic login
# - name: Set AutomaticLoginEnable to True
#   ini_file:
#     path: /etc/gdm/custom.conf
#     section: daemon
#     option: AutomaticLoginEnable
#     value: 'True'
#     mode: 0644
#   become: yes
  
# - name: Enable AutomaticLogin to the current user
#   ini_file:
#     path: /etc/gdm/custom.conf
#     section: daemon
#     option: AutomaticLogin
#     value: "{{ansible_user}}"
#     mode: 0644
#   become: yes
